*** Settings ***
Documentation     This test suite tests BORDER FOOLIB functionality
Suite Setup       Border Suite Setup
Suite Teardown    Border Suite Teardown
Test Teardown     Test Case Teardown
Force Tags        Product_Backlog_ID-xxx_1R_M1    EFS_ID-RNC_EFS_xxx    owner-I_EXT_NWS_WCDMA_RA_RI_HZSWD_STARTUP_TEAM_WEI@internal.nsn.com    exec_type-automatic    type-FUT    HW_TYPE-BCN_A1    BCN_STEP-BCN_S0
...               Phase-CRT    PRB-BORDER    PRB-FOOLIB
Default Tags      ready-for-a-team-jenkins
Library           Collections
Library           resources/metadata_test_framework.py
Library           resources/plan_generate.py
Variables         resources/TestResources.py    ${TEST_BENCH}
Library           OperatingSystem
Resource          resources/common_kws.txt

*** Variables ***
${TEST_BENCH}     ${HOST}    # ${TEST_BENCH}    pate56    ${TEST_BENCH}    prinsessa    ${TEST_BENCH}    bcn114

*** Test Cases ***
Direct Parameter Query Test (COCO)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    COCO    create_object_itself=${false}
    ####################################################################
    # Direct parameter query tests
    ${ismcRNC} =    ismcRNC
    Run Keyword Unless    ${ismcRNC}    COCO_atm_interface_creation
    Run Keyword Unless    ${ismcRNC}    Download Direct Parameter Query And Compare With Original    COCO    ${RNC-ID}/COCO-1

Direct Parameter Query Test (RNAC)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    RNAC    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    RNAC    ${RNC-ID}/RNAC-1

Direct Parameter Query Test (PFL)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    PFL    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    PFL    ${RNC-ID}/PFL-1

Direct Parameter Query Test (CBCI)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    CBCI    create_object_itself=${false}
    ${ignored_params}=    Create List    ICSUforCBC
    Download Direct Parameter Query And Compare With Original    CBCI    ${RNC-ID}/CBCI-1    ${ignored_params}

Direct Parameter Query Test (WSG)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    WSG    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    WSG    ${RNC-ID}/WSG-1

Direct Parameter Query Test (IUPSIP)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    IUPSIP    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    IUPSIP    ${RNC-ID}/IUPS-1/IUPSIP-1

Direct Parameter Query Test (IUCSIP)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    IUCSIP    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    IUCSIP    ${RNC-ID}/IUCS-1/IUCSIP-1

Direct Parameter Query Test (IUPS)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    IUPS    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    IUPS    ${RNC-ID}/IUPS-1

Direct Parameter Query Test (IUCS)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    IUCS    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    IUCS    ${RNC-ID}/IUCS-1

Direct Parameter Query Test (IUR)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    IUR    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    IUR    ${RNC-ID}/IUR-1

Direct Parameter Query Test (WANE)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    WANE    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    WANE    ${RNC-ID}/WANE-1

Direct Parameter Query Test (IPQM)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    IPQM    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    IPQM    ${RNC-ID}/IPQM-1

Direct Parameter Query Test (TQM)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    TQM    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    TQM    ${RNC-ID}/TQM-1

Direct Parameter Query Test (VCEL)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    VCEL    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    VCEL    ${RNC-ID}/VBTS-1/VCEL-1

Direct Parameter Query Test (WRAB)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    WRAB    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    WRAB    ${RNC-ID}/WRAB-1

Direct Parameter Query Test (RNFC)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    RNFC    create_object_itself=${false}
    # RIMUtraSIEnab is a new parameter
    ${ignored}=    Create List    RIMUtraSIEnab
    Download Direct Parameter Query And Compare With Original    RNFC    ${RNC-ID}/RNFC-1    ${ignored}

Direct Parameter Query Test (CMOB)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    CMOB    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    CMOB    ${RNC-ID}/CMOB-1

Direct Parameter Query Test (RNTRM)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    RNTRM    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    RNTRM    ${RNC-ID}/RNTRM-1

Direct Parameter Query Test (RNPS)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    RNPS    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    RNPS    ${RNC-ID}/RNPS-1

Direct Parameter Query Test (RNRLC)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    RNRLC    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    RNRLC    ${RNC-ID}/RNRLC-1

Direct Parameter Query Test (WAC)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    WAC    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    WAC    ${RNC-ID}/WAC-1

Direct Parameter Query Test (HOPL)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    HOPL    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    HOPL    ${RNC-ID}/HOPL-1

Direct Parameter Query Test (HOPG)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    HOPG    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    HOPG    ${RNC-ID}/HOPG-1

Direct Parameter Query Test (HOPS)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    HOPS    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    HOPS    ${RNC-ID}/HOPS-1

Direct Parameter Query Test (HOPI)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    HOPI    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    HOPI    ${RNC-ID}/HOPI-1

Direct Parameter Query Test (IUO)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    IUO    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    IUO    ${RNC-ID}/IUO-1

Direct Parameter Query Test (RNMOBI)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    RNMOBI    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    RNMOBI    ${RNC-ID}/RNMOBI-1

Direct Parameter Query Test (IPNB)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    IPNB    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    IPNB    ${RNC-ID}/IPNB-1

Direct Parameter Query Test (BKPRNC)
    [Tags]    ready-for-a-team-jenkins    nightly-test    need-robot-2.8
    [Setup]    create_base_config_for_object    BKPRNC    create_object_itself=${false}
    ${ismcRNC} =    ismcRNC
    #Pass Execution If    ${ismcRNC}    No BKPRNC in mcRNC
    Download Direct Parameter Query And Compare With Original    BKPRNC    ${RNC-ID}/BKP${RNC-ID}

Direct Parameter Query Test (FMCL)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    FMCL    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    FMCL    ${RNC-ID}/FMCL-1

Direct Parameter Query Test (VBTS)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    VBTS    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    VBTS    ${RNC-ID}/VBTS-1

Direct Parameter Query Test (RNC)
    [Tags]    ready-for-a-team-jenkins    nightly-test    
    [Setup]    create_base_config_for_object    RNC    create_object_itself=${false}
    # FullConsCheckRequest and ServingOMSSwoRequest are download only parameters in PDDB
    ${ignored_params}=    Create List    RncOptions    ServingOMSSwoRequest    FullConsCheckRequest    OMSIpAddress    ActivePRNC    OMSBackupIpAddress
    Download Direct Parameter Query And Compare With Original    RNC    ${RNC-ID}    ${ignored_params}

Direct Parameter Query Test (PREBTS)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    PREBTS    create_object_itself=${false}
    ${ismcRNC} =    ismcRNC
    Run Keyword Unless    ${ismcRNC}    Download Direct Parameter Query And Compare With Original    PREBTS    ${RNC-ID}/PREBTS-1

Direct Parameter Query Test (WLCSE)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    WLCSE    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    WLCSE    ${RNC-ID}/WLCSE-1

Direct Parameter Query Test (FMCS)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    FMCS    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    FMCS    ${RNC-ID}/FMCS-1

Direct Parameter Query Test (FMCI)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    FMCI    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    FMCI    ${RNC-ID}/FMCI-1

Direct Parameter Query Test (FMCG)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    FMCG    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    FMCG    ${RNC-ID}/FMCG-1

Direct Parameter Query Test (WSMLC)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    WSMLC    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    WSMLC    ${RNC-ID}/WSMLC-1

Direct Parameter Query Test (RNHSPA)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    RNHSPA    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    RNHSPA    ${RNC-ID}/RNHSPA-1

Direct Parameter Query Test (RNCERM)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    RNCERM    create_object_itself=${false}
    ${ismcRNC} =    ismcRNC
    Run Keyword If    ${ismcRNC}    Download Direct Parameter Query And Compare With Original    RNCERM    ${RNC-ID}/RNCERM-1

Direct Parameter Query Test (WBTS)
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    create_base_config_for_object    WBTS    create_object_itself=${false}
    Download Direct Parameter Query And Compare With Original    WBTS    ${RNC-ID}/WBTS-1

Direct Parameter Query Test (WCEL)
    [Tags]    ready-for-a-team-jenkins    nightly-test    
    [Setup]    create_base_config_for_object    WCEL    create_object_itself=${false}
    ${ignored_params}=    Create List    MBLBEnhancementsEnabled    HSPATotIncreaseStep
    Download Direct Parameter Query And Compare With Original    WCEL    ${RNC-ID}/WBTS-1/WCEL-1    ${ignored_params}

Direct Parameter Query Test (ADJL)
    [Tags]    ready-for-a-team-jenkins    nightly-test    
    [Setup]    create_base_config_for_object    ADJL    create_object_itself=${False}
    ${ignored_params}=    Create List    
    Download Direct Parameter Query And Compare With Original    ADJL    ${RNC-ID}/WBTS-1/WCEL-1/ADJL-1    ${ignored_params}

Direct Parameter Query Test (ADJI)
    [Tags]    ready-for-a-team-jenkins    nightly-test    
    [Setup]    create_base_config_for_object    ADJI    create_object_itself=${False}
    ${ignored_params}=    Create List    
    Download Direct Parameter Query And Compare With Original    ADJI    ${RNC-ID}/WBTS-1/WCEL-1/ADJI-1    ${ignored_params}

Direct Parameter Query Test (ADJS)
    [Tags]    ready-for-a-team-jenkins    nightly-test    
    [Setup]    create_base_config_for_object    ADJS    create_object_itself=${False}
    Download Direct Parameter Query And Compare With Original    ADJS    ${RNC-ID}/WBTS-1/WCEL-1/ADJS-1
    [Teardown]    Test Case Teardown With Delete    RNWPLAND_ADJS_delete.XML

Direct Parameter Query Test (ADJD)
    [Tags]    ready-for-a-team-jenkins    nightly-test    
    [Setup]    create_base_config_for_object    ADJD    create_object_itself=${False}
    Download Direct Parameter Query And Compare With Original    ADJD    ${RNC-ID}/WBTS-1/WCEL-1/ADJD-1
    [Teardown]    Test Case Teardown With Delete    RNWPLAND_ADJD_delete.XML

Direct Parameter Query Test (ADJG)
    [Tags]    ready-for-a-team-jenkins    nightly-test    
    [Setup]    create_base_config_for_object    ADJG    create_object_itself=${False}
    Download Direct Parameter Query And Compare With Original    ADJG    ${RNC-ID}/WBTS-1/WCEL-1/ADJG-1

Promotion DPQ Test
    [Tags]    ready-for-a-team-jenkins    promotion-test    
    [Setup]    Run Keywords    clean_all_except_rnc_objs_from_db
    ${ismcRNC} =    ismcRNC
    Run Keyword If    ${ismcRNC}==${false}    COCO_atm_interface_creation
    # Create test plan
    # Problematic objs, BKPRNC and PRNC cannot be combined
    ${excluded_objs}=    Create List    BKPRNC    RNCSRV    DATSYN    PRNC
    ${obj_plan_file_list}=    get_mo_plan_file_list    excluded_objs=${excluded_objs}
    ${obj_dict}=    combine_plans    ${obj_plan_file_list}    test_plan.xml    ${CURDIR}${/}test_files
    upload_a_file    test_plan.xml
    download_plan    test_plan.xml
    # RNFC/RIMUtraSIEnab is waiting new RAKTOR with support for RAN3086 CSFB with RIM
    ${ignored_params} =    Create List    RIMUtraSIEnab
    ${plan_xml}=    Get File    test_plan.xml
    ${cmdata_dl} =    get_cmdata_elem_from_text    ${plan_xml}
    @{objects} =    Get Dictionary Keys    ${obj_dict}
    : FOR    ${obj_name}    IN    @{objects}
    \    ${dist_name}=    Get From Dictionary    ${obj_dict}    ${obj_name}
    \    ${ul_xml} =    direct_obj_inquire    ${dist_name}
    \    ${cmdata_ul} =    get_cmdata_elem_from_text    ${ul_xml}
    \    Compare Plans    ${cmdata_dl}    ${cmdata_ul}    ${obj_name}    ${dist_name}    ${ignored_params}
    ####################
    # topology tests

Topology upload Combined
    [Tags]    ready-for-a-team-jenkins    nightly-test    
    [Setup]    Run Keywords    clean_all_except_rnc_objs_from_db
    ${ismcRNC} =    ismcRNC
    Run Keyword If    ${ismcRNC}==${false}    COCO_atm_interface_creation
    # Create test plan
    # Problematic objs, BKPRNC and DATSYN cannot be combined
    # ADJX objects are got from subtopology upload
    ${excluded_objs}=    Create List    RNCSRV    DATSYN    PRNC    ADJD    ADJG
    ...    ADJE    ADJI    ADJL    ADJS
    ${obj_plan_file_list}=    get_mo_plan_file_list    excluded_objs=${excluded_objs}
    #Run Keyword Unless    ${ismcRNC}    Insert Into List    ${obj_plan_file_list}    0    RNWPLAND_PRNC.XML
    ${obj_dict}=    combine_plans    ${obj_plan_file_list}    test_plan.xml    ${CURDIR}${/}test_files
    upload_a_file    test_plan.xml
    download_plan    test_plan.xml
    # RNCClusterOMLnkState is not returned by original code, even if it has topology interface defined in PDDB
    ${ignored_params}=    Create List    PRNCIP4Address    RNCIPAddress    RNCClusterOMLnkState    PRNCName
    ${ul}=    topology_upload
    Run Keyword Unless    ${ismcRNC}    Log    ${ul}
    ${org_file}=    Set Variable If    ${ismcRNC}    ${CURDIR}${/}test_files/RNWTOPOLOGY_COMB_org.XML    ${CURDIR}${/}test_files/RNWTOPOLOGY_COMB_org_cRNC.XML
    ${cmdata_new} =    get_cmdata_elem_from_text    ${ul}
    ${cmdata_org}=    get_cmdata_from_file    ${org_file}
    @{objects} =    Get Dictionary Keys    ${obj_dict}
    : FOR    ${obj_name}    IN    @{objects}
    \    ${dist_name}=    Get From Dictionary    ${obj_dict}    ${obj_name}
    \    Compare To Original    ${cmdata_org}    ${cmdata_new}    ${obj_name}    ${dist_name}    ${ignored_params}

Topology upload RNCIPAddress check
    [Tags]    
    ${ul}=    topology_upload
    ${rncipaddress}=    get_plan_param_value    ${ul}    ${RNC-ID}    RNCIPAddress
    Should Be Equal    ${rncipaddress}    ${IPADDRESS}
    [Teardown]    # clear_RNCIPAddress

Topology upload ADJX
    [Tags]    ready-for-a-team-jenkins    nightly-test
    [Setup]    Run Keywords    create_base_config_for_object    ADJD    create_object_itself=${false}    AND    create_base_config_for_object
    ...    ADJE    create_object_itself=${true}    AND    create_base_config_for_object    ADJI    create_object_itself=${true}
    ...    AND    create_base_config_for_object    ADJG    create_object_itself=${true}    AND    create_base_config_for_object
    ...    ADJL    create_object_itself=${true}    AND    create_base_config_for_object    ADJS    create_object_itself=${true}
    ${ismcRNC} =    ismcRNC
    # Create test plan
    # ADJX objects are got from subtopology upload
    ${obj_plan_file_list}=    Create List    RNWPLAND_ADJD.XML    RNWPLAND_ADJG.XML    RNWPLAND_ADJE.XML    RNWPLAND_ADJI.XML    RNWPLAND_ADJL.XML
    ...    RNWPLAND_ADJS.XML
    ${obj_dict}=    combine_plans    ${obj_plan_file_list}    test_plan.xml    ${CURDIR}${/}test_files
    upload_a_file    test_plan.xml
    download_plan    test_plan.xml
    ${ignored_params}=    Create List
    ${ul}=    topology_upload    ${RNC-ID}/WBTS-1/WCEL-1
    Run Keyword Unless    ${ismcRNC}    Log    ${ul}
    ${org_file}=    Set Variable If    ${ismcRNC}    ${CURDIR}${/}test_files/RNWTOPOLOGY_ADJX_org.XML    ${CURDIR}${/}test_files/RNWTOPOLOGY_ADJX_org_cRNC.XML
    ${cmdata_new} =    get_cmdata_elem_from_text    ${ul}
    ${cmdata_org}=    get_cmdata_from_file    ${org_file}
    @{objects} =    Get Dictionary Keys    ${obj_dict}
    : FOR    ${obj_name}    IN    @{objects}
    \    ${dist_name}=    Get From Dictionary    ${obj_dict}    ${obj_name}
    \    Compare To Original    ${cmdata_org}    ${cmdata_new}    ${obj_name}    ${dist_name}    ${ignored_params}
    ###################################
    # Change notification tests

OMS Change Notification Test Create Combined
    [Tags]    ready-for-a-team-jenkins        # nightly-test
    [Setup]    Run Keywords    clean_all_except_rnc_objs_from_db
    ${ismcRNC} =    ismcRNC
    Run Keyword If    ${ismcRNC}==${false}    COCO_atm_interface_creation
    # Problematic objs, BKPRNC and DATSYN cannot be combined
    ${excluded_objs}=    Create List    RNCSRV    DATSYN    PRNC    RNC    RNAC    RNFC    RNHSPA    RNMOBI    RNPS    RNRLC    RNTRM
    set_border_test_mode_on
    ${mon_handle}=    start_oms_change_notification_monitoring
    ${obj_dict}=    All Objects Download    ${empty}    ${excluded_objs}
    sleep    2
    stop_oms_change_notification_monitoring    ${mon_handle}
    # For some reason RNC creation is not included in change notifications
    Remove From Dictionary    ${obj_dict}    RNC    PRNC
    # COCO VCCBundleParams list is empty, although the original code returns full list with FF value
    # COCO Route, ANI and DATree: the original code does not return these, altough they have the EM interface
    # WBTS TargetId: the original code returns this, although it does not have the EM interface
    ${ignored_params}=    Create List    PRNCIP4Address    RNCIPAddress    RIMUtraSIEnab    TargetId    Route
    ...    ANI    DATree    VCCBundleParams    VCCBundleId    VCCBundlePCR    VCCBundleEBS
    ...    ICSUforCBC
    @{objects} =    Get Dictionary Keys    ${obj_dict}
    : FOR    ${obj_name}    IN    @{objects}
    \    ${dist_name}=    Get From Dictionary    ${obj_dict}    ${obj_name}
    \    ${org_file}=    Set Variable If    ${ismcRNC}    ${CURDIR}${/}test_files/RNWCHANGE_NOTIFICATION_${obj_name}_create_org.XML    ${CURDIR}${/}test_files/RNWCHANGE_NOTIFICATION_${obj_name}_create_org_cRNC.XML
    \    ${notification_xml}=    get_oms_change_event_xml    ${mon_handle}    ${dist_name}    create
    \    Log    ${notification_xml}
    \    ${cmdata_new} =    get_cmdata_elem_from_text    ${notification_xml}
    \    ${cmdata_org}=    get_cmdata_from_file    ${org_file}
    \    Compare To Original    ${cmdata_org}    ${cmdata_new}    ${obj_name}    ${dist_name}    ${ignored_params}

OMS Change Notification Test Delete Combined
    [Tags]    ready-for-a-team-jenkins    # nightly-test
    ${ismcRNC} =    ismcRNC
    Run Keyword If    ${ismcRNC}==${false}    COCO_atm_interface_creation
    # Problematic objs, BKPRNC and DATSYN cannot be combined
    # RNXXX objs cannot be deleted
    ${excluded_objs}=    Create List    RNCSRV    DATSYN    PRNC
    set_border_test_mode_on
    # Create part
    All Objects Download    ${empty}    ${excluded_objs}
    # Problematic objs, BKPRNC and DATSYN cannot be combined
    # RNXXX objs cannot be deleted
    ${excluded_objs}=    Create List    RNCSRV    DATSYN    PRNC    RNC    RNAC
    ...    RNPS    RNHSPA    RNMOBI    RNTRM    RNFC    RNRLC
    # delete
    ${mon_handle}=    start_oms_change_notification_monitoring
    ${obj_dict}=    All Objects Download    delete    ${excluded_objs}
    sleep    2
    stop_oms_change_notification_monitoring    ${mon_handle}
    ${ignored_params}=    Create List    PRNCIP4Address    RNCIPAddress
    @{objects} =    Get Dictionary Keys    ${obj_dict}
    : FOR    ${obj_name}    IN    @{objects}
    \    ${dist_name}=    Get From Dictionary    ${obj_dict}    ${obj_name}
    \    ${org_file}=    Set Variable If    ${ismcRNC}    ${CURDIR}${/}test_files/RNWCHANGE_NOTIFICATION_${obj_name}_delete_org.XML    ${CURDIR}${/}test_files/RNWCHANGE_NOTIFICATION_${obj_name}_delete_org_cRNC.XML
    \    ${notification_xml}=    get_oms_change_event_xml    ${mon_handle}    ${dist_name}    delete
    \    Log    ${notification_xml}
    \    ${cmdata_new} =    get_cmdata_elem_from_text    ${notification_xml}
    \    ${cmdata_org}=    get_cmdata_from_file    ${org_file}
    \    Compare To Original    ${cmdata_org}    ${cmdata_new}    ${obj_name}    ${dist_name}    ${ignored_params}
    # Order is important here, starting with WCEL + ADJX

OMS Change Notification Test Modify WCEL
    [Setup]    create_base_config_for_object    WCEL    create_object_itself=${false}
    ${xml_elems}=    Create List    <p name="AbsPrioCellReselec">3</p><p name="AdminCellState">1</p><p name="RACHPreambleSignatures">1</p>
    Change Notification Modify With XML Items And Compare To Original    WCEL    ${RNC-ID}/WBTS-1/WCEL-1    ${xml_elems}

OMS Change Notification Test Modify LCEL modified
    [Setup]    create_base_config_for_object    WCEL    create_object_itself=${true}
    # When WBTS is created BORDER also gets lbts_modified_event_s
    ${mon_handle}=    start_oms_change_notification_monitoring
    send_lcel_modified_event
    sleep    1
    stop_oms_change_notification_monitoring    ${mon_handle}
    # Org BORDER does not send ICRCapability, but new BORDER does, because it has the EM interface
    ${ignored}=    Create List    ICRCapability
    Compare Extra Change Notification To Original    WCEL    ${RNC-ID}/WBTS-1/WCEL-1    ${mon_handle}    lcel_modified    ignored_params=${ignored}

OMS Change Notification Test Modify WSTA modified
    [Setup]    create_base_config_for_object    WCEL    create_object_itself=${true}
    ${mon_handle}=    start_oms_change_notification_monitoring
    send_wsta_modified_event
    sleep    1
    stop_oms_change_notification_monitoring    ${mon_handle}
    Compare Extra Change Notification To Original    WCEL    ${RNC-ID}/WBTS-1/WCEL-1    ${mon_handle}    wsta_modified

OMS Change Notification Test Modify ADJL
    [Setup]    create_base_config_for_object    ADJL    create_object_itself=${false}
    Change Notification Modify And Compare To Original    ADJL    ${RNC-ID}/WBTS-1/WCEL-1/ADJL-1

OMS Change Notification Test Modify ADJI
    [Setup]    create_base_config_for_object    ADJI    create_object_itself=${false}
    Change Notification Modify And Compare To Original    ADJI    ${RNC-ID}/WBTS-1/WCEL-1/ADJI-1

OMS Change Notification Test Modify ADJS
    [Setup]    create_base_config_for_object    ADJS    create_object_itself=${false}
    Change Notification Modify And Compare To Original    ADJS    ${RNC-ID}/WBTS-1/WCEL-1/ADJS-1

OMS Change Notification Test Modify ADJD
    [Setup]    create_base_config_for_object    ADJD    create_object_itself=${false}
    Change Notification Modify And Compare To Original    ADJD    ${RNC-ID}/WBTS-1/WCEL-1/ADJD-1

OMS Change Notification Test Modify ADJG
    [Setup]    create_base_config_for_object    ADJG    create_object_itself=${false}
    Change Notification Modify And Compare To Original    ADJG    ${RNC-ID}/WBTS-1/WCEL-1/ADJG-1

OMS Change Notification Test Modify ADJE
    [Setup]    create_base_config_for_object    ADJE    create_object_itself=${false}
    ${xml_elems}=    Create List    <p name="AdjeCellId">2</p><p name="AdjeMNCLength">3</p>
    Change Notification Modify With XML Items And Compare To Original    ADJE    ${RNC-ID}/WBTS-1/WCEL-1/ADJE-1    ${xml_elems}
    # RNXXX

OMS Change Notification Test Modify RNC
    [Setup]    create_base_config_for_object    RNC    create_object_itself=${false}
    Change Notification Modify And Compare To Original    RNC    ${RNC-ID}

OMS Change Notification Test Modify RNAC
    [Setup]    create_base_config_for_object    RNAC    create_object_itself=${false}
    Change Notification Modify And Compare To Original    RNAC    ${RNC-ID}/RNAC-1

OMS Change Notification Test Modify RNTRM
    [Setup]    create_base_config_for_object    RNTRM    create_object_itself=${false}
    ${xml_elems}=    Create List    <list name="ActivityFactorForAMRDCHTrafficBearers"><item><p name="Af122AMRDL">62</p></item></list>
    Append To List    ${xml_elems}    <p name="DSCPBTSOMToBTS">40</p>
    Change Notification Modify With XML Items And Compare To Original    RNTRM    ${RNC-ID}/RNTRM-1    ${xml_elems}

OMS Change Notification Test Modify RNPS
    [Setup]    create_base_config_for_object    RNPS    create_object_itself=${false}
    Change Notification Modify And Compare To Original    RNPS    ${RNC-ID}/RNPS-1

OMS Change Notification Test Modify RNRLC
    [Setup]    create_base_config_for_object    RNRLC    create_object_itself=${false}
    Change Notification Modify And Compare To Original    RNRLC    ${RNC-ID}/RNRLC-1

OMS Change Notification Test Modify RNMOBI
    [Setup]    create_base_config_for_object    RNMOBI    create_object_itself=${false}
    Change Notification Modify And Compare To Original    RNMOBI    ${RNC-ID}/RNMOBI-1

OMS Change Notification Test Modify RNFC
    [Setup]    create_base_config_for_object    RNFC    create_object_itself=${false}
    Change Notification Modify And Compare To Original    RNFC    ${RNC-ID}/RNFC-1

OMS Change Notification Test Modify RNHSPA
    [Setup]    create_base_config_for_object    RNHSPA    create_object_itself=${false}
    Change Notification Modify And Compare To Original    RNHSPA    ${RNC-ID}/RNHSPA-1

OMS Change Notification Test Modify RNCERM
    [Tags]    need-robot-2.8
    [Setup]    create_base_config_for_object    RNCERM    create_object_itself=${false}
    ${ismcRNC} =    ismcRNC
    Pass Execution If    ${ismcRNC}==${false}    No RNCERM in cRNC
    Change Notification Modify And Compare To Original    RNCERM    ${RNC-ID}/RNCERM-1
    # These require only RNXXX

OMS Change Notification Test Modify WRAB
    [Setup]    create_base_config_for_object    WRAB    create_object_itself=${false}
    Change Notification Modify And Compare To Original    WRAB    ${RNC-ID}/WRAB-1

OMS Change Notification Test Modify COCO
    [Tags]    need-robot-2.8
    [Setup]    create_base_config_for_object    COCO    create_object_itself=${false}
    ${ismcRNC} =    ismcRNC
    Pass Execution If    ${ismcRNC}    No COCO in mcRNC
    COCO_atm_interface_creation
    download_plan    RNWPLAND_COCO_minimal.XML
    ${ignored}=    Create List    COCOA2EA    Route    ANI    DATree
    Change Notification Modify And Compare To Original    COCO    ${RNC-ID}/COCO-1    ignored_params=${ignored}

OMS Change Notification Test Modify NBAP Link State
    [Tags]    need-robot-2.8
    [Setup]    create_base_config_for_object    COCO    create_object_itself=${false}
    ${ismcRNC} =    ismcRNC
    Pass Execution If    ${ismcRNC}    No COCO in mcRNC
    COCO_atm_interface_creation
    download_plan    RNWPLAND_COCO_minimal.XML
    ${mon_handle}=    start_oms_change_notification_monitoring
    send_nbap_link_state    link_id=0    # C-NBAP
    sleep    1
    stop_oms_change_notification_monitoring    ${mon_handle}
    Compare Extra Change Notification To Original    COCO    ${RNC-ID}/COCO-1    ${mon_handle}    nbap_link_state_cnbap
    ${mon_handle}=    start_oms_change_notification_monitoring
    send_nbap_link_state    link_id=1    # D-NBAP
    sleep    1
    stop_oms_change_notification_monitoring    ${mon_handle}
    Compare Extra Change Notification To Original    COCO    ${RNC-ID}/COCO-1    ${mon_handle}    nbap_link_state_dnbap

OMS Change Notification Test Modify IUR
    [Setup]    create_base_config_for_object    IUR    create_object_itself=${false}
    Change Notification Modify And Compare To Original    IUR    ${RNC-ID}/IUR-1

OMS Change Notification Test Modify PFL
    [Setup]    create_base_config_for_object    PFL    create_object_itself=${false}
    Change Notification Modify And Compare To Original    PFL    ${RNC-ID}/PFL-1

OMS Change Notification Test Modify IUO
    [Setup]    create_base_config_for_object    IUO    create_object_itself=${false}
    Change Notification Modify And Compare To Original    IUO    ${RNC-ID}/IUO-1

OMS Change Notification Test Modify WANE
    [Setup]    create_base_config_for_object    WANE    create_object_itself=${false}
    Change Notification Modify And Compare To Original    WANE    ${RNC-ID}/WANE-1

OMS Change Notification Test Modify IPQM
    [Setup]    create_base_config_for_object    IPQM    create_object_itself=${false}
    # RNWPLAND_IPQM.XML contains only default value parameters so we cannot use that here
    # because it does not modify anything
    ${xml_elems}=    Create List    <p name="BackgroundTCToDSCP">3</p><p name="ConversationalTCToDSCP">50</p><p name="InteractiveTHP1TCToDSCP">50</p>
    Append To List    ${xml_elems}    <p name="InteractiveTHP2TCToDSCP">40</p><p name="InteractiveTHP3TCToDSCP">20</p><p name="StreamingTCToDSCP">35</p>
    Change Notification Modify With XML Items And Compare To Original    IPQM    ${RNC-ID}/IPQM-1    ${xml_elems}

OMS Change Notification Test Modify TQM
    [Setup]    create_base_config_for_object    TQM    create_object_itself=${false}
    # RNWPLAND_TQM.XML contains only default value parameters so we cannot use that here
    # because it does not modify anything
    ${xml_elems}=    Create List    <list name="AFForHSPATrafficBearers"><item><p name="AfHSDPAQoSPri0">20</p><p name="AfHSUPAQoSPri1">30</p></item></list>
    Append To List    ${xml_elems}    <list name="QosPriToDSCP"><item><p name="CSTrafficToDSCP">20</p><p name="DCHQoSPri0ToDSCP">40</p></item></list>
    Append To List    ${xml_elems}    <list name="QosPriToAAL2PT"><item><p name="CSTrafficToAAL2PT">18</p><p name="DCHQoSPri0ToAAL2PT">17</p><p name="SRBToAAL2PT">37</p></item></list>
    Change Notification Modify With XML Items And Compare To Original    TQM    ${RNC-ID}/TQM-1    ${xml_elems}

OMS Change Notification Test Modify CMOB
    [Setup]    create_base_config_for_object    CMOB    create_object_itself=${false}
    Change Notification Modify And Compare To Original    CMOB    ${RNC-ID}/CMOB-4

OMS Change Notification Test Modify WAC
    [Setup]    create_base_config_for_object    WAC    create_object_itself=${false}
    # RNWPLAND_WAC.XML is filled with default values so we cannot use it here
    ${xml_elems}=    Create List    <p name="DCHUtilRelAveWin">50</p><list name="InactivityTimerDownlinkDCH"><item><p name="InactivityTimerDownlinkDCH128">15</p><p name="InactivityTimerDownlinkDCH320">13</p></item></list>
    Change Notification Modify With XML Items And Compare To Original    WAC    ${RNC-ID}/WAC-1    ${xml_elems}

OMS Change Notification Test Modify IPNB
    [Setup]    create_base_config_for_object    IPNB    create_object_itself=${false}
    Change Notification Modify And Compare To Original    IPNB    ${RNC-ID}/IPNB-1

OMS Change Notification Test Modify IPNB NBAP SCTP Link State
    [Setup]    create_base_config_for_object    IPNB    create_object_itself=${false}
    download_plan    RNWPLAND_IPNB_minimal.XML
    # Special case for nbap_sctp_link_state_s notification msg
    ${mon_handle}=    start_oms_change_notification_monitoring
    send_nbap_sctp_link_state_event    1    1
    sleep    2
    stop_oms_change_notification_monitoring    ${mon_handle}
    Compare Extra Change Notification To Original    IPNB    ${RNC-ID}/IPNB-1    ${mon_handle}    nbap_sctp_link_state

OMS Change Notification Test Modify BKPRNC
    [Tags]    need-robot-2.8
    [Setup]    create_base_config_for_object    BKPRNC    create_object_itself=${false}
    ${ismcRNC} =    ismcRNC
    #Pass Execution If    ${ismcRNC}    No BKPRNC in mcRNC
    Change Notification Modify And Compare To Original    BKPRNC    ${RNC-ID}/BKP${RNC-ID}

OMS Change Notification Test Modify FMCL
    [Setup]    create_base_config_for_object    FMCL    create_object_itself=${false}
    Change Notification Modify And Compare To Original    FMCL    ${RNC-ID}/FMCL-1

OMS Change Notification Test Modify PREBTS
    [Tags]    need-robot-2.8
    [Setup]    create_base_config_for_object    PREBTS    create_object_itself=${false}
    ${ismcRNC} =    ismcRNC
    Pass Execution If    ${ismcRNC}    No PREBTS in mcRNC
    Change Notification Modify And Compare To Original    PREBTS    ${RNC-ID}/PREBTS-1

OMS Change Notification Test Modify FMCS
    [Setup]    create_base_config_for_object    FMCS    create_object_itself=${false}
    ${xml_elems}=    Create List    <p name="AdditionTime">3</p> <p name="DropWindow">13</p>
    Change Notification Modify With XML Items And Compare To Original    FMCS    ${RNC-ID}/FMCS-1    ${xml_elems}

OMS Change Notification Test Modify FMCI
    [Setup]    create_base_config_for_object    FMCI    create_object_itself=${false}
    ${xml_elems}=    Create List    <p name="IFHOcauseCPICHEcNo">1</p> <p name="MBLBMobilityRABComb">1</p>
    Change Notification Modify With XML Items And Compare To Original    FMCI    ${RNC-ID}/FMCI-1    ${xml_elems}

OMS Change Notification Test Modify FMCG
    [Setup]    create_base_config_for_object    FMCG    create_object_itself=${false}
    ${xml_elems}=    Create List    <p name="GSMcauseCPICHEcNo">1</p><p name="GsmDLTxPwrThrAMR">-12</p>
    Change Notification Modify With XML Items And Compare To Original    FMCG    ${RNC-ID}/FMCG-1    ${xml_elems}

OMS Change Notification Test Modify WSMLC
    [Setup]    create_base_config_for_object    WSMLC    create_object_itself=${false}
    Change Notification Modify And Compare To Original    WSMLC    ${RNC-ID}/WSMLC-1
    # These require some of above

OMS Change Notification Test Modify CBCI
    [Setup]    create_base_config_for_object    CBCI    create_object_itself=${false}
    Change Notification Modify And Compare To Original    CBCI    ${RNC-ID}/CBCI-1

OMS Change Notification Test Modify WSG
    [Setup]    create_base_config_for_object    WSG    create_object_itself=${false}
    Change Notification Modify And Compare To Original    WSG    ${RNC-ID}/WSG-1

OMS Change Notification Test Modify IUCS
    [Setup]    create_base_config_for_object    IUCS    create_object_itself=${false}
    Change Notification Modify And Compare To Original    IUCS    ${RNC-ID}/IUCS-1

OMS Change Notification Test Modify IUPS
    [Setup]    create_base_config_for_object    IUPS    create_object_itself=${false}
    Change Notification Modify And Compare To Original    IUPS    ${RNC-ID}/IUPS-1

OMS Change Notification Test Modify WBTS
    [Setup]    create_base_config_for_object    WBTS    create_object_itself=${false}
    Change Notification Modify And Compare To Original    WBTS    ${RNC-ID}/WBTS-1

OMS Change Notification Test Modify WBTS LBTS Modified Event
    [Setup]    create_base_config_for_object    WBTS    create_object_itself=${false}
    # When WBTS is created BORDER also gets lbts_modified_event_s
    ${mon_handle}=    start_oms_change_notification_monitoring
    download_plan    RNWPLAND_WBTS_minimal.XML
    sleep    1
    stop_oms_change_notification_monitoring    ${mon_handle}
    ${ignored}=    Create List    TargetId
    Compare Extra Change Notification To Original    WBTS    ${RNC-ID}/WBTS-1    ${mon_handle}    lbts_modified    ignored_params=${ignored}

OMS Change Notification Test Modify HOPL
    [Setup]    create_base_config_for_object    HOPL    create_object_itself=${false}
    Change Notification Modify And Compare To Original    HOPL    ${RNC-ID}/HOPL-1

OMS Change Notification Test Modify HOPG
    [Setup]    create_base_config_for_object    HOPG    create_object_itself=${false}
    Change Notification Modify And Compare To Original    HOPG    ${RNC-ID}/HOPG-1

OMS Change Notification Test Modify HOPS
    [Setup]    create_base_config_for_object    HOPS    create_object_itself=${false}
    Change Notification Modify And Compare To Original    HOPS    ${RNC-ID}/HOPS-1

OMS Change Notification Test Modify HOPI
    [Setup]    create_base_config_for_object    HOPI    create_object_itself=${false}
    Change Notification Modify And Compare To Original    HOPI    ${RNC-ID}/HOPI-1

OMS Change Notification Test Modify VBTS
    [Setup]    create_base_config_for_object    VBTS    create_object_itself=${false}
    Change Notification Modify And Compare To Original    VBTS    ${RNC-ID}/VBTS-1

OMS Change Notification Test Modify WLCSE
    [Setup]    create_base_config_for_object    WLCSE    create_object_itself=${false}
    Change Notification Modify And Compare To Original    WLCSE    ${RNC-ID}/WLCSE-1
    # Require more

OMS Change Notification Test Modify VCEL
    [Setup]    create_base_config_for_object    VCEL    create_object_itself=${false}
    Change Notification Modify And Compare To Original    VCEL    ${RNC-ID}/VBTS-1/VCEL-1

OMS Change Notification Test Modify IUPSIP
    [Setup]    create_base_config_for_object    IUPSIP    create_object_itself=${false}
    Change Notification Modify And Compare To Original    IUPSIP    ${RNC-ID}/IUPS-1/IUPSIP-1

OMS Change Notification Test Modify IUCSIP
    [Setup]    create_base_config_for_object    IUCSIP    create_object_itself=${false}
    Change Notification Modify And Compare To Original    IUCSIP    ${RNC-ID}/IUCS-1/IUCSIP-1

*** Keywords ***
All Objects Download
    [Arguments]    ${plan_type}    ${excluded_objs}
    # Create test plan
    ${obj_plan_file_list}=    get_mo_plan_file_list    ${plan_type}    excluded_objs=${excluded_objs}
    ${obj_dict}=    combine_plans    ${obj_plan_file_list}    test_plan.xml    ${CURDIR}${/}test_files
    upload_a_file    test_plan.xml
    download_plan    test_plan.xml
    [Return]    ${obj_dict}

Download Direct Parameter Query And Compare With Original
    [Arguments]    ${obj_name}    ${dist_name}    ${ignored_params}=${empty}
    [Documentation]    Download full plan, do direct parameter query and compare the result plan with the plan make with original BORDER version
    download_plan    RNWPLAND_${obj_name}.XML
    Query and Compare With Original    ${obj_name}    ${dist_name}    ${ignored_params}

Border Suite Setup
    #Suite Setup with restart DB
    Suite Setup
    wait_rnwdb_normal
    set_border_test_mode_on
    add_RNCIPAddress

Border Suite Teardown
    set_border_test_mode_off
    Suite Teardown

